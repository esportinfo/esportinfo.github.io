<!doctype html>
<html lang="th">
 <head>
  <meta charset="UTF-8">
  <title>ฝ่ายงบประมาณโรงเรียนสระแก้ว</title><!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script><!-- Canva SDKs -->
  <script src="/_sdk/element_sdk.js"></script>
  <style>
      body {
        box-sizing: border-box;
      }

      html,
      body {
        height: 100%;
        width: 100%;
      }

      /* Smooth focus outlines for accessibility */
      :focus-visible {
        outline: 3px solid rgba(59, 130, 246, 0.8);
        outline-offset: 3px;
      }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="w-full h-full">
  <header class="w-full"><!-- ใ��้ header ว่า��เ��ื่อโครงสร้าง semantic -->
  </header>
  <main id="app-root" class="w-full h-full flex flex-col items-center justify-center px-6" aria-labelledby="page-title"><!-- พื้นหลังหลักของหน้า -->
   <div id="app-background" class="w-full h-full max-w-4xl mx-auto rounded-3xl shadow-xl flex flex-col items-center justify-center transition-colors duration-300" style="background: linear-gradient(135deg, #fef08a 0%, #bef264 50%, #86efac 100%);"><!-- โลโก้ + ข้อความ และเมนูรวมอยู่ในคอนเทนเนอร์ -->
    <section class="w-full flex flex-col items-center justify-center gap-10 py-10"><!-- พื้นที่โลโก้ -->
     <div class="flex flex-col items-center gap-4"><!-- ���ลโ��้���ูปภาพ -->
      <div id="logo-slot" class="flex items-center justify-center" aria-label="โลโก้โรงเรียนสระแก้ว"><img src="https://img2.pic.in.th/pic/sakaeo-logo-01e069aaa713786278.png" alt="โลโก้โรงเรียนสระแก้ว" id="logo-image" style="width: 270px; height: 270px; object-fit: contain;" onerror="this.style.display='none'; document.getElementById('logo-initials').style.display='inline';"> <!-- ตัวอักษรสำรองกรณีรูปโหลดไม่ได้ --> <span id="logo-initials" class="font-semibold tracking-wide select-none" style="display: none;"> SK </span>
      </div><!-- ข้อความชื่อหน่วยงาน -->
      <h1 id="page-title" class="text-center font-semibold tracking-wide">ฝ่ายงบประมาณโรงเ��ียนส���ะแก้ว</h1>
     </div><!-- เมนูกลาง 3 ปุ่ม -->
     <nav aria-label="เมนูหลักฝ่ายงบป���ะมา��" class="w-full flex justify-center">
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 w-full max-w-xl"><!-- การเงิน --> <button id="menu-finance-button" type="button" class="menu-button group"> <span id="menu-finance-text" class="menu-button-text"> การเงิน </span> </button> <!-- แผน --> <button id="menu-plan-button" type="button" class="menu-button group"> <span id="menu-plan-text" class="menu-button-text"> แผน </span> </button> <!-- พัสดุ --> <button id="menu-asset-button" type="button" class="menu-button group"> <span id="menu-asset-text" class="menu-button-text"> พัสดุ </span> </button>
      </div>
     </nav><!-- พื้นที่ข้อความสถานะ / คำอธิบายด้��นล��า��เมนู -->
     <p id="status-text" class="mt-4 text-center text-sm opacity-80 max-w-md">เลือกเมนูด้านบนเพื่อไปยังส่วนงานที่ต้องการ</p>
    </section>
   </div>
  </main>
  <footer class="w-full py-4 text-center text-xs opacity-70"><!-- เว้นว่างหรือใส่ข้อความภายหลังได้ -->
  </footer>
  <script>
      // -------------------------------
      // ค่าเริ่มต้นของการตั้งค่า (Config)
      // -------------------------------
      const defaultConfig = {
        // ข้อความต่าง ๆ
        main_title: "ฝ่ายงบประมาณโรงเรียนสระแก้ว",
        menu_finance: "การเงิน",
        menu_plan: "แผน",
        menu_asset: "พัสดุ",

        // สีหลัก (สูงสุด 5 สี)
        // 1. พื้นหลังหลักของหน้า
        background_color: "#fef3c7",
        // 2. พื้นผิวรอง (การ์ด / กล่อง)
        surface_color: "#ffffff",
        // 3. สีตัวอักษร
        text_color: "#111827",
        // 4. สีปุ่มหลัก / เมนู
        primary_action_color: "#2563eb",
        // 5. สีปุ่มรอง / เส้นขอบ / ไฮไลต์
        secondary_action_color: "#e5e7eb",

        // ฟอนต์และขนาดตัวอักษร
        font_family: "Prompt",
        font_size: 16
      };

      // เก็บ element อ้างอิงไว้ใช้ใน onConfigChange
      const elements = {
        appBackground: null,
        body: null,
        mainTitle: null,
        logoSlot: null,
        logoImage: null,
        logoInitials: null,
        menuFinanceText: null,
        menuPlanText: null,
        menuAssetText: null,
        statusText: null,
        menuButtons: []
      };

      // -------------------------------
      // ฟังก์ชันอัปเดต UI ตาม config
      // -------------------------------
      async function onConfigChange(config) {
        const cfg = Object.assign({}, defaultConfig, config || {});

        const baseSize = cfg.font_size || defaultConfig.font_size;
        const fontFamily = cfg.font_family || defaultConfig.font_family;

        const primaryFontStack = `${fontFamily}, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`;

        // ดึง elements ถ้าย�����ไม่ได้เซ็ต
        if (!elements.body) {
          elements.body = document.body;
        }
        if (!elements.appBackground) {
          elements.appBackground = document.getElementById("app-background");
        }
        if (!elements.mainTitle) {
          elements.mainTitle = document.getElementById("page-title");
        }
        if (!elements.logoSlot) {
          elements.logoSlot = document.getElementById("logo-slot");
        }
        if (!elements.logoImage) {
          elements.logoImage = document.getElementById("logo-image");
        }
        if (!elements.logoInitials) {
          elements.logoInitials = document.getElementById("logo-initials");
        }
        if (!elements.menuFinanceText) {
          elements.menuFinanceText =
            document.getElementById("menu-finance-text");
        }
        if (!elements.menuPlanText) {
          elements.menuPlanText = document.getElementById("menu-plan-text");
        }
        if (!elements.menuAssetText) {
          elements.menuAssetText = document.getElementById("menu-asset-text");
        }
        if (!elements.statusText) {
          elements.statusText = document.getElementById("status-text");
        }
        if (!elements.menuButtons.length) {
          elements.menuButtons = [
            document.getElementById("menu-finance-button"),
            document.getElementById("menu-plan-button"),
            document.getElementById("menu-asset-button")
          ];
        }

        // ---- ใช้ค่า config ปรับข้อความ ----
        if (elements.mainTitle) {
          elements.mainTitle.textContent =
            cfg.main_title || defaultConfig.main_title;
        }
        if (elements.menuFinanceText) {
          elements.menuFinanceText.textContent =
            cfg.menu_finance || defaultConfig.menu_finance;
        }
        if (elements.menuPlanText) {
          elements.menuPlanText.textContent =
            cfg.menu_plan || defaultConfig.menu_plan;
        }
        if (elements.menuAssetText) {
          elements.menuAssetText.textContent =
            cfg.menu_asset || defaultConfig.menu_asset;
        }

        // ---- ��ช้ค่า config ปรับ��ี ----

        // สีพื้นหล��งหลักของ body
        if (elements.body) {
          elements.body.style.backgroundColor =
            cfg.background_color || defaultConfig.background_color;
        }

        // สีพื้นผิวการ์ดหลัก (ไม่ต้องเปลี่ยนเพราะใช้ gradient แล้ว)
        // if (elements.appBackground) {
        //   elements.appBackground.style.backgroundColor =
        //     cfg.surface_color || defaultConfig.surface_color;
        // }

        // สีข้อความหลัก
        const textColor = cfg.text_color || defaultConfig.text_color;
        if (elements.mainTitle) {
          elements.mainTitle.style.color = textColor;
        }
        if (elements.statusText) {
          elements.statusText.style.color = textColor;
        }
        if (elements.logoInitials) {
          elements.logoInitials.style.color = textColor;
        }

        // สีปุ่มเมนู
        const primaryColor =
          cfg.primary_action_color || defaultConfig.primary_action_color;
        const secondaryColor =
          cfg.secondary_action_color || defaultConfig.secondary_action_color;
        elements.menuButtons.forEach((btn) => {
          if (!btn) return;
          btn.style.backgroundColor = primaryColor;
          btn.style.borderColor = secondaryColor;
          btn.style.color = "#ffffff";
        });

        // ---- ใช้ค่า config ปรับฟอนต์ + ขนาดตัวอักษร ----

        // ขนาดแ���ะฟอนต์ของข้���ความหลัก
        if (elements.mainTitle) {
          elements.mainTitle.style.fontFamily = primaryFontStack;
          elements.mainTitle.style.fontSize = baseSize * 1.6 + "px";
        }

        if (elements.statusText) {
          elements.statusText.style.fontFamily = primaryFontStack;
          elements.statusText.style.fontSize = baseSize * 0.85 + "px";
        }

        if (elements.logoInitials) {
          elements.logoInitials.style.fontFamily = primaryFontStack;
          elements.logoInitials.style.fontSize = baseSize * 1.3 + "px";
        }

        // ปุ่มเมนู
        elements.menuButtons.forEach((btn) => {
          if (!btn) return;
          btn.style.fontFamily = primaryFontStack;
          btn.style.fontSize = baseSize * 1.05 + "px";
          btn.style.borderRadius = "9999px";
          btn.style.padding = `${baseSize * 0.75}px ${baseSize * 1.5}px`;
        });
      }

      // -------------------------------
      // ตั้งค่า Tailwind class เสริมผ่าน JS
      // (เพราะเราจะ���ช้ร่วมกับ onConfigChange)
      // -------------------------------
      function applyBaseClasses() {
        // เพิ่มยูทิลิตีพื้นฐานที่ใช้ซ้ำให้ปุ่ม
        const style = document.createElement("style");
        style.textContent = `
          .menu-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            border-width: 1px;
            font-weight: 500;
            letter-spacing: 0.02em;
            transition-property: transform, box-shadow, background-color, color, border-color;
            transition-duration: 150ms;
          }
          .menu-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 20px rgba(15, 23, 42, 0.18);
          }
          .menu-button:active {
            transform: translateY(0);
            box-shadow: 0 4px 10px rgba(15, 23, 42, 0.18);
          }
          .menu-button-text {
            white-space: nowrap;
          }
        `;
        document.head.appendChild(style);
      }

      // -------------------------------
      // เริ่มต้น Element SDK
      // -------------------------------
      (async function initElementSdk() {
        applyBaseClasses();

        if (!window.elementSdk) {
          // ถ้าเปิดในเบราว์เซอร์ป��ติ (นอก Canva)
          // ��ห้เรนเดอร์��้วยค่า defaultConfig เฉย ๆ
          await onConfigChange(defaultConfig);
          setupMenuInteractions();
          return;
        }

        window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities: (config) => {
            const cfg = Object.assign({}, defaultConfig, config || {});

            // Recolorables: background, surface, text, primary, secondary
            const recolorables = [
              {
                get: () => cfg.background_color || defaultConfig.background_color,
                set: (value) => {
                  cfg.background_color = value;
                  window.elementSdk.setConfig({ background_color: value });
                }
              },
              {
                get: () => cfg.surface_color || defaultConfig.surface_color,
                set: (value) => {
                  cfg.surface_color = value;
                  window.elementSdk.setConfig({ surface_color: value });
                }
              },
              {
                get: () => cfg.text_color || defaultConfig.text_color,
                set: (value) => {
                  cfg.text_color = value;
                  window.elementSdk.setConfig({ text_color: value });
                }
              },
              {
                get: () =>
                  cfg.primary_action_color ||
                  defaultConfig.primary_action_color,
                set: (value) => {
                  cfg.primary_action_color = value;
                  window.elementSdk.setConfig({ primary_action_color: value });
                }
              },
              {
                get: () =>
                  cfg.secondary_action_color ||
                  defaultConfig.secondary_action_color,
                set: (value) => {
                  cfg.secondary_action_color = value;
                  window.elementSdk.setConfig({
                    secondary_action_color: value
                  });
                }
              }
            ];

            return {
              recolorables,
              borderables: [],
              fontEditable: {
                get: () => cfg.font_family || defaultConfig.font_family,
                set: (value) => {
                  cfg.font_family = value;
                  window.elementSdk.setConfig({ font_family: value });
                }
              },
              fontSizeable: {
                get: () => cfg.font_size || defaultConfig.font_size,
                set: (value) => {
                  cfg.font_size = value;
                  window.elementSdk.setConfig({ font_size: value });
                }
              }
            };
          },
          mapToEditPanelValues: (config) => {
            const cfg = Object.assign({}, defaultConfig, config || {});
            return new Map([
              ["main_title", cfg.main_title || defaultConfig.main_title],
              ["menu_finance", cfg.menu_finance || defaultConfig.menu_finance],
              ["menu_plan", cfg.menu_plan || defaultConfig.menu_plan],
              ["menu_asset", cfg.menu_asset || defaultConfig.menu_asset]
            ]);
          }
        });

        // เรนเดอร์ครั้งแรกด้วย config ปัจจุบัน
        await onConfigChange(window.elementSdk.config || defaultConfig);
        setupMenuInteractions();
      })();

      // -------------------------------
      // Interaction: แสดงข้อความเมื่อกดเมนู
      // -------------------------------
      function setupMenuInteractions() {
        const status = document.getElementById("status-text");
        const financeBtn = document.getElementById("menu-finance-button");
        const planBtn = document.getElementById("menu-plan-button");
        const assetBtn = document.getElementById("menu-asset-button");

        if (!status) return;

        function setStatus(text) {
          status.textContent = text;
        }

        if (financeBtn) {
          financeBtn.addEventListener("click", () => {
            window.open("https://drive.google.com/drive/folders/1O6yx0fkQmV5pAdfln3cJMJ8RtRQhTE3C", "_blank", "noopener,noreferrer");
            setStatus("กำลังเปิดหน้างานการเงินในแท็บใหม่...");
          });
        }

        if (planBtn) {
          planBtn.addEventListener("click", () => {
            window.open("https://sites.google.com/sakaeoschool.ac.th/plansk/%E0%B8%AB%E0%B8%99%E0%B8%B2%E0%B9%81%E0%B8%A3%E0%B8%81", "_blank", "noopener,noreferrer");
            setStatus("กำลังเปิดหน้างานแผนในแท็บใหม่...");
          });
        }

        if (assetBtn) {
          assetBtn.addEventListener("click", () => {
            window.open("https://drive.google.com/drive/folders/1RuzDVZryPfcSPBz84o81FODOkJDVwKk4", "_blank", "noopener,noreferrer");
            setStatus("กำลังเปิดหน้างานพัสดุในแท็บใหม่...");
          });
        }
      }
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a56fea251417323',t:'MTc2NDMwMjgwNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>

</html>
